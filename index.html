<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Manager V5.0 Lite - Optimization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div id="root"></div>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const YOUTUBE_CLIENT_ID = '209770688632-orkjj4ga1n6eotqv5966m7nrkvkpijdf.apps.googleusercontent.com';
        const YOUTUBE_API_KEY = 'AIzaSyDuaNXVMqAUVsuw2zjXANidGo0iK1rPfMU';

        function App() {
          // States
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [user, setUser] = useState(null);
          const [currentTab, setCurrentTab] = useState('home');
          const [channels, setChannels] = useState([]);
          const [hashtags, setHashtags] = useState([]);
          const [keywords, setKeywords] = useState([]);
          const [comments, setComments] = useState([]);
          const [logs, setLogs] = useState([]);
          const [isMonitoring, setIsMonitoring] = useState(false);
          const [apiUsage, setApiUsage] = useState({ youtube: 0, anthropic: 0, saved: 0 }); // saved ì¶”ê°€
          const [monitoringInterval, setMonitoringInterval] = useState(5);
          const [lastCheck, setLastCheck] = useState({});
          const [commentFilter, setCommentFilter] = useState('all');
          const [aiEnabled, setAiEnabled] = useState(false);
          const [aiStyle, setAiStyle] = useState('friendly');
          const [anthropicApiKey, setAnthropicApiKey] = useState('');
          
          // V5.0 Lite ìµœì í™”
          const [checkedVideoIds, setCheckedVideoIds] = useState({}); // í™•ì¸í•œ ì˜ìƒ ID
          const [myCommentedVideos, setMyCommentedVideos] = useState([]); // ë‚´ê°€ ëŒ“ê¸€ ë‹¨ ì˜ìƒ
          const [optimization, setOptimization] = useState({
            enabled: true, // ìµœì í™” í™œì„±í™”
            skipCommented: true, // ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸°
            batchSize: 5, // ë°°ì¹˜ í¬ê¸° ì œí•œ
            maxVideoAge: 24 // ìµœëŒ€ ì˜ìƒ ë‚˜ì´ (ì‹œê°„) - ê¸°ë³¸ 24ì‹œê°„ (ì˜¤ëŠ˜)
          });
          
          // Refs
          const tokenClientRef = useRef(null);
          const accessTokenRef = useRef(null);
          const monitoringTimerRef = useRef(null);
          
          // Initialize
          useEffect(() => {
            initGoogleIdentityServices();
            
            // Load from localStorage
            const saved = localStorage.getItem('yt_fetch_data');
            if (saved) {
              const data = JSON.parse(saved);
              if (data.channels) setChannels(data.channels);
              if (data.hashtags) setHashtags(data.hashtags);
              if (data.keywords) setKeywords(data.keywords);
              if (data.comments) setComments(data.comments);
              if (data.logs) setLogs(data.logs);
              if (data.apiUsage) setApiUsage(data.apiUsage);
              if (data.monitoringInterval) setMonitoringInterval(data.monitoringInterval);
              if (data.lastCheck) setLastCheck(data.lastCheck);
              if (data.aiEnabled !== undefined) setAiEnabled(data.aiEnabled);
              if (data.aiStyle) setAiStyle(data.aiStyle);
              if (data.anthropicApiKey) setAnthropicApiKey(data.anthropicApiKey);
              // V5.0 Lite
              if (data.checkedVideoIds) setCheckedVideoIds(data.checkedVideoIds);
              if (data.myCommentedVideos) setMyCommentedVideos(data.myCommentedVideos);
              if (data.optimization) setOptimization(data.optimization);
            }
          }, []);
          
          // Save to localStorage
          useEffect(() => {
            localStorage.setItem('yt_fetch_data', JSON.stringify({
              channels, hashtags, keywords, comments, logs, apiUsage, monitoringInterval, lastCheck, aiEnabled, aiStyle, anthropicApiKey,
              checkedVideoIds, myCommentedVideos, optimization
            }));
          }, [channels, hashtags, keywords, comments, logs, apiUsage, monitoringInterval, lastCheck, aiEnabled, aiStyle, anthropicApiKey,
              checkedVideoIds, myCommentedVideos, optimization]);
          
          // Cleanup on unmount
          useEffect(() => {
            return () => {
              if (monitoringTimerRef.current) {
                clearInterval(monitoringTimerRef.current);
              }
            };
          }, []);
          
          // Google Identity Services
          const initGoogleIdentityServices = () => {
            if (!window.google) {
              setTimeout(initGoogleIdentityServices, 100);
              return;
            }
            
            try {
              tokenClientRef.current = google.accounts.oauth2.initTokenClient({
                client_id: YOUTUBE_CLIENT_ID,
                scope: 'https://www.googleapis.com/auth/youtube.force-ssl',
                callback: (response) => {
                  if (response.error) {
                    addLog(`âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${response.error}`, 'error');
                    return;
                  }
                  accessTokenRef.current = response.access_token;
                  handleAuthSuccess();
                }
              });
              addLog('âœ… Google Identity Services ì´ˆê¸°í™” ì™„ë£Œ', 'success');
            } catch (error) {
              addLog(`âŒ GIS ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, 'error');
            }
          };
          
          // Auth
          const handleLogin = () => {
            if (!tokenClientRef.current) {
              addLog('âš ï¸ GISê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤', 'warning');
              return;
            }
            addLog('ğŸ”‘ ë¡œê·¸ì¸ ì¤‘...', 'info');
            tokenClientRef.current.requestAccessToken();
          };
          
          const handleAuthSuccess = async () => {
            try {
              const response = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                headers: { 'Authorization': `Bearer ${accessTokenRef.current}` }
              });
              
              const userInfo = await response.json();
              
              // user ë¨¼ì € ì„¤ì •
              setUser({
                name: userInfo.name,
                email: userInfo.email,
                image: userInfo.picture
              });
              
              // ê·¸ ë‹¤ìŒ isAuthenticated ì„¤ì •
              setIsAuthenticated(true);
              
              addLog(`âœ… ${userInfo.name}ë‹˜ ë¡œê·¸ì¸ ì„±ê³µ!`, 'success');
            } catch (error) {
              addLog(`âŒ ì¸ì¦ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
          };
          
          const handleLogout = () => {
            if (accessTokenRef.current) {
              google.accounts.oauth2.revoke(accessTokenRef.current);
            }
            accessTokenRef.current = null;
            setIsAuthenticated(false);
            setUser(null);
            setIsMonitoring(false);
            addLog('âœ… ë¡œê·¸ì•„ì›ƒ', 'info');
          };
          
          // Utils
          const addLog = (msg, type = 'info') => {
            const log = {
              id: Date.now(),
              time: new Date().toLocaleTimeString('ko-KR'),
              msg,
              type
            };
            setLogs(prev => [log, ...prev].slice(0, 100));
          };
          
          // URLì„ ë§í¬ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
          const renderLogMessage = (msg) => {
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            const parts = msg.split(urlRegex);
            
            return parts.map((part, index) => {
              if (part.match(urlRegex)) {
                return (
                  <a
                    key={index}
                    href={part}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-blue-600 hover:underline font-medium"
                  >
                    {part}
                  </a>
                );
              }
              return <span key={index}>{part}</span>;
            });
          };
          
          // YouTube API - Fetch ê¸°ë°˜
          const youtubeAPI = {
            async getChannel(input) {
              try {
                // 1ë‹¨ê³„: ì±„ë„ IDì¸ ê²½ìš° ì§ì ‘ ì¡°íšŒ
                if (input.startsWith('UC') && input.length > 20) {
                  console.log('ğŸ” ì±„ë„ IDë¡œ ì§ì ‘ ì¡°íšŒ:', input);
                  const url = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${input}&key=${YOUTUBE_API_KEY}`;
                  const response = await fetch(url);
                  const data = await response.json();
                  
                  if (data.error) {
                    console.error('âŒ API ì—ëŸ¬:', data.error);
                    return null;
                  }
                  
                  if (data.items && data.items.length > 0) {
                    console.log('âœ… ì±„ë„ ì°¾ìŒ:', data.items[0].snippet.title);
                    return data.items[0];
                  }
                }
                
                // 2ë‹¨ê³„: í•¸ë“¤ì´ë‚˜ ì±„ë„ëª…ì¸ ê²½ìš° Search API ì‚¬ìš©
                const query = input.startsWith('@') ? input.substring(1) : input;
                console.log('ğŸ” Search APIë¡œ ê²€ìƒ‰:', query);
                
                const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=channel&maxResults=5&key=${YOUTUBE_API_KEY}`;
                const searchResponse = await fetch(searchUrl);
                const searchData = await searchResponse.json();
                
                console.log('ğŸ“¥ Search ì‘ë‹µ:', searchData);
                
                if (searchData.error) {
                  console.error('âŒ Search ì—ëŸ¬:', searchData.error);
                  return null;
                }
                
                if (!searchData.items || searchData.items.length === 0) {
                  console.warn('âš ï¸ ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ');
                  return null;
                }
                
                // 3ë‹¨ê³„: ì°¾ì€ ì±„ë„ IDë¡œ ìƒì„¸ ì •ë³´ ì¡°íšŒ
                const channelId = searchData.items[0].id.channelId;
                console.log('ğŸ” ìƒì„¸ ì •ë³´ ì¡°íšŒ:', channelId);
                
                const detailUrl = `https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${channelId}&key=${YOUTUBE_API_KEY}`;
                const detailResponse = await fetch(detailUrl);
                const detailData = await detailResponse.json();
                
                if (detailData.items && detailData.items.length > 0) {
                  console.log('âœ… ì±„ë„ ìƒì„¸ ì •ë³´ íšë“:', detailData.items[0].snippet.title);
                  return detailData.items[0];
                }
                
                return null;
              } catch (error) {
                console.error('âŒ ì „ì²´ ì—ëŸ¬:', error);
                return null;
              }
            },
            
            async searchVideos(channelId, maxResults = 5) {
              const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&order=date&maxResults=${maxResults}&type=video&key=${YOUTUBE_API_KEY}`;
              const response = await fetch(url);
              const data = await response.json();
              return data.items || [];
            },
            
            async postComment(videoId, commentText) {
              const url = 'https://www.googleapis.com/youtube/v3/commentThreads?part=snippet';
              const response = await fetch(url, {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer ${accessTokenRef.current}`,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  snippet: {
                    videoId: videoId,
                    topLevelComment: {
                      snippet: {
                        textOriginal: commentText
                      }
                    }
                  }
                })
              });
              return await response.json();
            }
          };
          
          // Channel Management
          const addChannel = async () => {
            const input = prompt('ì±„ë„ì„ ì…ë ¥í•˜ì„¸ìš”:\n\nì˜ˆì‹œ:\n- @SPOTV (í•¸ë“¤)\n- SPOTV (í•¸ë“¤, @ ì—†ì´)\n- UCxxx... (ì±„ë„ ID)');
            if (!input) return;
            
            const channelId = input.trim();
            
            try {
              addLog(`ğŸ” ì±„ë„ ì •ë³´ ê°€ì ¸ì˜¤ëŠ” ì¤‘: ${channelId}`, 'info');
              
              const channelData = await youtubeAPI.getChannel(channelId);
              
              if (!channelData) {
                addLog('âŒ ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
                alert('ì±„ë„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\në‹¤ìŒì„ í™•ì¸í•´ì£¼ì„¸ìš”:\n1. @SPOTV (í•¸ë“¤)\n2. UCxxx... (ì±„ë„ ID)\n3. ì² ìê°€ ì •í™•í•œì§€ í™•ì¸');
                return;
              }
              
              const patterns = prompt('ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš” (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):')
                ?.split('\n').filter(p => p.trim());
              
              if (!patterns || patterns.length === 0) {
                addLog('âŒ ëŒ“ê¸€ íŒ¨í„´ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                return;
              }
              
              const newChannel = {
                id: channelData.id, // ì‹¤ì œ ì±„ë„ ID ì €ì¥
                handle: channelId.startsWith('@') ? channelId : null,
                name: channelData.snippet.title,
                thumbnail: channelData.snippet.thumbnails.default.url,
                subscribers: channelData.statistics.subscriberCount,
                patterns,
                enabled: true,
                addedAt: new Date().toISOString()
              };
              
              setChannels(prev => [...prev, newChannel]);
              setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 1 }));
              addLog(`âœ… ì±„ë„ ì¶”ê°€ë¨: ${newChannel.name}`, 'success');
            } catch (error) {
              addLog(`âŒ ì±„ë„ ì¶”ê°€ ì‹¤íŒ¨: ${error.message}`, 'error');
            }
          };
          
          const removeChannel = (id) => {
            if (confirm('ì´ ì±„ë„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
              setChannels(prev => prev.filter(c => c.id !== id));
              addLog('âœ… ì±„ë„ ì‚­ì œë¨', 'info');
            }
          };
          
          const toggleChannel = (id) => {
            setChannels(prev => prev.map(c =>
              c.id === id ? { ...c, enabled: !c.enabled } : c
            ));
          };
          
          // Hashtag Management
          const addHashtag = () => {
            const tag = prompt('í•´ì‹œíƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (# ì—†ì´):');
            if (!tag || !tag.trim()) return;
            
            const patterns = prompt('ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš” (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):')
              ?.split('\n').filter(p => p.trim());
            
            if (!patterns || patterns.length === 0) {
              addLog('âŒ ëŒ“ê¸€ íŒ¨í„´ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
              return;
            }
            
            const newHashtag = {
              id: `hashtag_${Date.now()}`,
              tag: tag.trim().replace(/^#/, ''), // # ì œê±°
              patterns,
              enabled: true,
              addedAt: new Date().toISOString()
            };
            
            setHashtags(prev => [...prev, newHashtag]);
            addLog(`âœ… í•´ì‹œíƒœê·¸ ì¶”ê°€ë¨: #${newHashtag.tag}`, 'success');
          };
          
          const removeHashtag = (id) => {
            if (confirm('ì´ í•´ì‹œíƒœê·¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
              setHashtags(prev => prev.filter(h => h.id !== id));
              addLog('âœ… í•´ì‹œíƒœê·¸ ì‚­ì œë¨', 'info');
            }
          };
          
          const toggleHashtag = (id) => {
            setHashtags(prev => prev.map(h =>
              h.id === id ? { ...h, enabled: !h.enabled } : h
            ));
          };
          
          // Keyword Management
          const addKeyword = () => {
            const term = prompt('ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (!term || !term.trim()) return;
            
            const patterns = prompt('ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš” (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):')
              ?.split('\n').filter(p => p.trim());
            
            if (!patterns || patterns.length === 0) {
              addLog('âŒ ëŒ“ê¸€ íŒ¨í„´ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
              return;
            }
            
            // ê²€ìƒ‰ ì¡°ê±´
            const minViews = prompt('ìµœì†Œ ì¡°íšŒìˆ˜ (0 = ì œí•œì—†ìŒ):') || '0';
            
            const newKeyword = {
              id: `keyword_${Date.now()}`,
              term: term.trim(),
              patterns,
              minViews: parseInt(minViews),
              enabled: true,
              addedAt: new Date().toISOString()
            };
            
            setKeywords(prev => [...prev, newKeyword]);
            addLog(`âœ… í‚¤ì›Œë“œ ì¶”ê°€ë¨: "${newKeyword.term}"`, 'success');
          };
          
          const removeKeyword = (id) => {
            if (confirm('ì´ í‚¤ì›Œë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
              setKeywords(prev => prev.filter(k => k.id !== id));
              addLog('âœ… í‚¤ì›Œë“œ ì‚­ì œë¨', 'info');
            }
          };
          
          const toggleKeyword = (id) => {
            setKeywords(prev => prev.map(k =>
              k.id === id ? { ...k, enabled: !k.enabled } : k
            ));
          };
          
          // ğŸ†• V5.0 Lite Optimization Functions
          
          // ë‚´ê°€ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (í•œ ë²ˆë§Œ ì‹¤í–‰)
          const fetchMyCommentedVideos = async () => {
            if (!optimization.enabled || !optimization.skipCommented) return;
            if (myCommentedVideos.length > 0) return; // ì´ë¯¸ ê°€ì ¸ì™”ìœ¼ë©´ ìŠ¤í‚µ
            
            try {
              addLog('ğŸ” ë‚´ê°€ ëŒ“ê¸€ ë‹¨ ì˜ìƒ í™•ì¸ ì¤‘...', 'info');
              
              const url = `https://www.googleapis.com/youtube/v3/commentThreads?part=snippet&mine=true&maxResults=100&key=${YOUTUBE_API_KEY}`;
              const response = await fetch(url, {
                headers: {
                  'Authorization': `Bearer ${accessTokenRef.current}`
                }
              });
              
              const data = await response.json();
              setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 1 }));
              
              if (data.items) {
                const videoIds = data.items.map(item => item.snippet.videoId);
                setMyCommentedVideos(videoIds);
                addLog(`âœ… ë‚´ ëŒ“ê¸€ ${videoIds.length}ê°œ í™•ì¸ ì™„ë£Œ`, 'success');
                return videoIds;
              }
              
              return [];
              
            } catch (error) {
              addLog(`âš ï¸ ë‚´ ëŒ“ê¸€ í™•ì¸ ì‹¤íŒ¨: ${error.message}`, 'warning');
              return [];
            }
          };
          
          // ì˜ìƒì´ ì´ë¯¸ ëŒ“ê¸€ ì‘ì„±ë¨ì¸ì§€ í™•ì¸
          const isVideoCommented = (videoId) => {
            if (!optimization.enabled || !optimization.skipCommented) return false;
            
            // 1. myCommentedVideosì— ìˆëŠ”ì§€ í™•ì¸
            if (myCommentedVideos.includes(videoId)) {
              return true;
            }
            
            // 2. comments ë°°ì—´ì—ì„œ í™•ì¸
            const commented = comments.some(c => c.videoId === videoId);
            return commented;
          };
          
          // ì˜ìƒ IDê°€ ì´ë¯¸ ì²´í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
          const isVideoChecked = (sourceId, videoId) => {
            if (!optimization.enabled) return false;
            if (!checkedVideoIds[sourceId]) return false;
            return checkedVideoIds[sourceId].includes(videoId);
          };
          
          // ì˜ìƒ IDë¥¼ ì²´í¬ë¨ìœ¼ë¡œ í‘œì‹œ
          const markVideoChecked = (sourceId, videoId) => {
            setCheckedVideoIds(prev => ({
              ...prev,
              [sourceId]: [...(prev[sourceId] || []), videoId]
            }));
          };
          
          // ë°°ì¹˜ í¬ê¸° ì œí•œìœ¼ë¡œ ì˜ìƒ ëª©ë¡ ìë¥´ê¸°
          const limitBatchSize = (videos) => {
            if (!optimization.enabled || !optimization.batchSize) return videos;
            return videos.slice(0, optimization.batchSize);
          };
          
          // ì˜ìƒì´ ë„ˆë¬´ ì˜¤ë˜ë˜ì—ˆëŠ”ì§€ ì²´í¬
          const isVideoTooOld = (publishedAt) => {
            if (!optimization.enabled || !optimization.maxVideoAge) return false;
            
            const now = Date.now();
            const publishTime = new Date(publishedAt).getTime();
            const ageInHours = (now - publishTime) / (1000 * 60 * 60);
            
            return ageInHours > optimization.maxVideoAge;
          };
          
          // ìµœì í™” ì´ˆê¸°í™”
          const resetOptimization = () => {
            setCheckedVideoIds({});
            setMyCommentedVideos([]);
            setApiUsage(prev => ({ ...prev, saved: 0 }));
            addLog('âœ… ìµœì í™” ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ', 'success');
          };
          
          // AI Comment Generation
          const generateAIComment = async (videoTitle, videoDescription = '') => {
            if (!aiEnabled) return null;
            
            // API í‚¤ í™•ì¸
            if (!anthropicApiKey || !anthropicApiKey.trim()) {
              addLog(`âŒ AI API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ğŸ¤– AI íƒ­ì—ì„œ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”.`, 'error');
              return null;
            }
            
            try {
              addLog(`ğŸ¤– AI ëŒ“ê¸€ ìƒì„± ì¤‘...`, 'info');
              
              const stylePrompts = {
                friendly: 'ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ í†¤ìœ¼ë¡œ',
                professional: 'ì „ë¬¸ì ì´ê³  ì •ì¤‘í•œ í†¤ìœ¼ë¡œ',
                enthusiastic: 'ì—´ì •ì ì´ê³  í¥ë¯¸ì§„ì§„í•œ í†¤ìœ¼ë¡œ',
                casual: 'í¸ì•ˆí•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ í†¤ìœ¼ë¡œ'
              };
              
              const stylePrompt = stylePrompts[aiStyle] || stylePrompts.friendly;
              
              const prompt = `ë‹¹ì‹ ì€ YouTube ì˜ìƒì— ëŒ“ê¸€ì„ ì‘ì„±í•˜ëŠ” í•œêµ­ì–´ ì‚¬ìš©ìì…ë‹ˆë‹¤.

ì˜ìƒ ì œëª©: "${videoTitle}"
${videoDescription ? `ì˜ìƒ ì„¤ëª…: "${videoDescription.substring(0, 200)}"` : ''}

ìœ„ ì˜ìƒì— ëŒ€í•´ ${stylePrompt} 1-2ë¬¸ì¥ì˜ ê°„ë‹¨í•œ ëŒ“ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

ê·œì¹™:
- ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ì‘ì„±
- 1-2ë¬¸ì¥, ìµœëŒ€ 50ì ì´ë‚´
- ìì—°ìŠ¤ëŸ½ê³  ì§„ì •ì„± ìˆê²Œ
- ìŠ¤íŒ¸ì²˜ëŸ¼ ë³´ì´ì§€ ì•Šê²Œ
- êµ¬ë…/ì¢‹ì•„ìš” ìš”ì²­ ê¸ˆì§€
- ì´ëª¨ì§€ ì‚¬ìš© ìµœì†Œí™”

ëŒ“ê¸€ë§Œ ì¶œë ¥í•˜ê³  ë‹¤ë¥¸ ì„¤ëª…ì€ í•˜ì§€ ë§ˆì„¸ìš”.`;

              const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'x-api-key': anthropicApiKey,
                  'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                  model: 'claude-sonnet-4-20250514',
                  max_tokens: 150,
                  messages: [
                    { role: 'user', content: prompt }
                  ]
                })
              });
              
              if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                throw new Error(`AI API ì—ëŸ¬: ${response.status} - ${errorData.error?.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬'}`);
              }
              
              const data = await response.json();
              const aiComment = data.content[0].text.trim();
              
              setApiUsage(prev => ({ ...prev, anthropic: prev.anthropic + 1 }));
              addLog(`ğŸ¤– AI ëŒ“ê¸€ ìƒì„± ì™„ë£Œ: "${aiComment}"`, 'success');
              
              return aiComment;
              
            } catch (error) {
              addLog(`âŒ AI ëŒ“ê¸€ ìƒì„± ì‹¤íŒ¨: ${error.message}`, 'error');
              return null;
            }
          };
          
          // Monitoring
          const checkNewVideos = async () => {
            const activeChannels = channels.filter(c => c.enabled);
            
            // V5.0 Lite: ë‚´ê°€ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ëª©ë¡ ë¨¼ì € ê°€ì ¸ì˜¤ê¸°
            if (optimization.enabled && optimization.skipCommented) {
              await fetchMyCommentedVideos();
            }
            
            for (const channel of activeChannels) {
              try {
                addLog(`ğŸ” ${channel.name} ì±„ë„ í™•ì¸ ì¤‘...`, 'info');
                
                // V5.0 Lite: ë°°ì¹˜ í¬ê¸° ì œí•œ ì ìš©
                const batchSize = optimization.enabled && optimization.batchSize ? optimization.batchSize : 50;
                const videos = await youtubeAPI.searchVideos(channel.id, batchSize);
                setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 100 }));
                
                if (videos.length === 0) {
                  addLog(`ğŸ“¹ ${channel.name}: ìƒˆ ì˜ìƒ ì—†ìŒ`, 'info');
                  continue;
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì´í›„ ìƒˆ ì˜ìƒë§Œ í•„í„°ë§
                const lastCheckTime = lastCheck[channel.id] || 0;
                let newVideos = videos.filter(video => {
                  const publishedAt = new Date(video.snippet.publishedAt).getTime();
                  return publishedAt > lastCheckTime;
                });
                
                if (newVideos.length === 0) {
                  addLog(`ğŸ“¹ ${channel.name}: ìƒˆ ì˜ìƒ ì—†ìŒ (ë§ˆì§€ë§‰ ì²´í¬: ${new Date(lastCheckTime).toLocaleString('ko-KR')})`, 'info');
                  continue;
                }
                
                // V5.0 Lite: ìµœì í™” í•„í„°ë§
                let skippedCount = 0;
                let optimizedVideos = [];
                
                for (const video of newVideos) {
                  const videoId = video.id.videoId;
                  const publishedAt = video.snippet.publishedAt;
                  
                  // ğŸ†• ì˜ìƒì´ ë„ˆë¬´ ì˜¤ë˜ë˜ì—ˆëŠ”ì§€ ì²´í¬
                  if (isVideoTooOld(publishedAt)) {
                    const ageInHours = Math.floor((Date.now() - new Date(publishedAt).getTime()) / (1000 * 60 * 60));
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì˜¤ë˜ëœ ì˜ìƒ (${ageInHours}ì‹œê°„ ì „)`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  // ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoCommented(videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ ëŒ“ê¸€ ì‘ì„±í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 })); // ê²€ìƒ‰(100) + ëŒ“ê¸€(50) ì ˆì•½
                    continue;
                  }
                  
                  // ì´ë¯¸ ì²´í¬í•œ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoChecked(channel.id, videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ í™•ì¸í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  optimizedVideos.push(video);
                  markVideoChecked(channel.id, videoId);
                }
                
                if (skippedCount > 0) {
                  addLog(`ğŸ’¡ ìµœì í™”: ${skippedCount}ê°œ ì˜ìƒ ê±´ë„ˆëœ€ (API ${skippedCount * 150} units ì ˆì•½!)`, 'success');
                }
                
                if (optimizedVideos.length === 0) {
                  addLog(`ğŸ“¹ ${channel.name}: ìƒˆ ì˜ìƒ ì—†ìŒ (ìµœì í™” í•„í„°ë§ í›„)`, 'info');
                  continue;
                }
                
                addLog(`ğŸ“¹ ${channel.name}: ${optimizedVideos.length}ê°œ ìƒˆ ì˜ìƒ ë°œê²¬!`, 'success');
                
                // ìƒˆ ì˜ìƒì— ëŒ“ê¸€ ì‘ì„±
                for (const video of optimizedVideos) {
                  // AI ëŒ“ê¸€ ìƒì„± ì‹œë„ ë˜ëŠ” íŒ¨í„´ ì‚¬ìš©
                  let commentText;
                  let isAI = false;
                  
                  if (aiEnabled) {
                    commentText = await generateAIComment(video.snippet.title, video.snippet.description);
                    if (commentText) {
                      isAI = true;
                    } else {
                      // AI ì‹¤íŒ¨ ì‹œ íŒ¨í„´ ì‚¬ìš©
                      commentText = channel.patterns[Math.floor(Math.random() * channel.patterns.length)];
                    }
                  } else {
                    commentText = channel.patterns[Math.floor(Math.random() * channel.patterns.length)];
                  }
                  
                  addLog(`ğŸ’¬ ëŒ“ê¸€ ì‘ì„± ì¤‘: "${commentText}"`, 'info');
                  
                  try {
                    const result = await youtubeAPI.postComment(video.id.videoId, commentText);
                    
                    const commentLink = `https://www.youtube.com/watch?v=${video.id.videoId}&lc=${result.id}`;
                    
                    const newComment = {
                      id: result.id,
                      videoId: video.id.videoId,
                      videoTitle: video.snippet.title,
                      text: commentText,
                      timestamp: new Date().toISOString(),
                      channel: channel.name,
                      // ì¶œì²˜ ì •ë³´
                      source: isAI ? 'ai' : 'channel',
                      sourceDetail: isAI ? 'AI ìƒì„±' : channel.name,
                      method: isAI ? 'ai-generated' : 'monitoring',
                      icon: isAI ? 'ğŸ¤–' : 'ğŸ“º',
                      label: isAI ? 'AI' : 'ì±„ë„'
                    };
                    
                    setComments(prev => [newComment, ...prev]);
                    setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 50 }));
                    addLog(`âœ… [${isAI ? 'ğŸ¤– AI' : 'ğŸ“º ì±„ë„'}] ${channel.name} - ëŒ“ê¸€ ì‘ì„± ì™„ë£Œ!`, 'success');
                    addLog(`ğŸ”— ëŒ“ê¸€ ë§í¬: ${commentLink}`, 'info');
                  } catch (error) {
                    addLog(`âŒ ëŒ“ê¸€ ì‘ì„± ì‹¤íŒ¨: ${error.message}`, 'error');
                  }
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì‹œê°„ ì—…ë°ì´íŠ¸
                setLastCheck(prev => ({
                  ...prev,
                  [channel.id]: Date.now()
                }));
                
              } catch (error) {
                addLog(`âŒ ${channel.name} ì²˜ë¦¬ ì‹¤íŒ¨: ${error.message}`, 'error');
              }
            }
            
            // í•´ì‹œíƒœê·¸ ëª¨ë‹ˆí„°ë§
            const activeHashtags = hashtags.filter(h => h.enabled);
            
            for (const hashtag of activeHashtags) {
              try {
                addLog(`ğŸ” í•´ì‹œíƒœê·¸ #${hashtag.tag} ê²€ìƒ‰ ì¤‘...`, 'info');
                
                // V5.0 Lite: ë°°ì¹˜ í¬ê¸° ì œí•œ ì ìš©
                const batchSize = optimization.enabled && optimization.batchSize ? optimization.batchSize : 5;
                
                // í•´ì‹œíƒœê·¸ë¡œ ì˜ìƒ ê²€ìƒ‰
                const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=%23${encodeURIComponent(hashtag.tag)}&type=video&order=date&maxResults=${batchSize}&key=${YOUTUBE_API_KEY}`;
                const searchResponse = await fetch(searchUrl);
                const searchData = await searchResponse.json();
                setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 100 }));
                
                if (!searchData.items || searchData.items.length === 0) {
                  addLog(`ğŸ“¹ #${hashtag.tag}: ìƒˆ ì˜ìƒ ì—†ìŒ`, 'info');
                  continue;
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì´í›„ ìƒˆ ì˜ìƒë§Œ í•„í„°ë§
                const lastCheckTime = lastCheck[hashtag.id] || 0;
                let newVideos = searchData.items.filter(item => {
                  const publishedAt = new Date(item.snippet.publishedAt).getTime();
                  return publishedAt > lastCheckTime;
                });
                
                if (newVideos.length === 0) {
                  addLog(`ğŸ“¹ #${hashtag.tag}: ìƒˆ ì˜ìƒ ì—†ìŒ (ë§ˆì§€ë§‰ ì²´í¬: ${new Date(lastCheckTime).toLocaleString('ko-KR')})`, 'info');
                  continue;
                }
                
                // V5.0 Lite: ìµœì í™” í•„í„°ë§
                let skippedCount = 0;
                let optimizedVideos = [];
                
                for (const video of newVideos) {
                  const videoId = video.id.videoId;
                  const publishedAt = video.snippet.publishedAt;
                  
                  // ğŸ†• ì˜ìƒì´ ë„ˆë¬´ ì˜¤ë˜ë˜ì—ˆëŠ”ì§€ ì²´í¬
                  if (isVideoTooOld(publishedAt)) {
                    const ageInHours = Math.floor((Date.now() - new Date(publishedAt).getTime()) / (1000 * 60 * 60));
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì˜¤ë˜ëœ ì˜ìƒ (${ageInHours}ì‹œê°„ ì „)`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  // ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoCommented(videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ ëŒ“ê¸€ ì‘ì„±í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  // ì´ë¯¸ ì²´í¬í•œ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoChecked(hashtag.id, videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ í™•ì¸í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  optimizedVideos.push(video);
                  markVideoChecked(hashtag.id, videoId);
                }
                
                if (skippedCount > 0) {
                  addLog(`ğŸ’¡ ìµœì í™”: ${skippedCount}ê°œ ì˜ìƒ ê±´ë„ˆëœ€ (API ${skippedCount * 150} units ì ˆì•½!)`, 'success');
                }
                
                if (optimizedVideos.length === 0) {
                  addLog(`ğŸ“¹ #${hashtag.tag}: ìƒˆ ì˜ìƒ ì—†ìŒ (ìµœì í™” í•„í„°ë§ í›„)`, 'info');
                  continue;
                }
                
                addLog(`ğŸ“¹ #${hashtag.tag}: ${optimizedVideos.length}ê°œ ìƒˆ ì˜ìƒ ë°œê²¬!`, 'success');
                
                // ìƒˆ ì˜ìƒì— ëŒ“ê¸€ ì‘ì„±
                for (const video of optimizedVideos) {
                  // AI ëŒ“ê¸€ ìƒì„± ì‹œë„ ë˜ëŠ” íŒ¨í„´ ì‚¬ìš©
                  let commentText;
                  let isAI = false;
                  
                  if (aiEnabled) {
                    commentText = await generateAIComment(video.snippet.title, video.snippet.description);
                    if (commentText) {
                      isAI = true;
                    } else {
                      // AI ì‹¤íŒ¨ ì‹œ íŒ¨í„´ ì‚¬ìš©
                      commentText = hashtag.patterns[Math.floor(Math.random() * hashtag.patterns.length)];
                    }
                  } else {
                    commentText = hashtag.patterns[Math.floor(Math.random() * hashtag.patterns.length)];
                  }
                  
                  addLog(`ğŸ’¬ ëŒ“ê¸€ ì‘ì„± ì¤‘: "${commentText}"`, 'info');
                  
                  try {
                    const result = await youtubeAPI.postComment(video.id.videoId, commentText);
                    
                    const commentLink = `https://www.youtube.com/watch?v=${video.id.videoId}&lc=${result.id}`;
                    
                    const newComment = {
                      id: result.id,
                      videoId: video.id.videoId,
                      videoTitle: video.snippet.title,
                      text: commentText,
                      timestamp: new Date().toISOString(),
                      channel: video.snippet.channelTitle,
                      // ì¶œì²˜ ì •ë³´
                      source: isAI ? 'ai' : 'hashtag',
                      sourceDetail: isAI ? 'AI ìƒì„±' : `#${hashtag.tag}`,
                      method: isAI ? 'ai-generated' : 'hashtag-search',
                      icon: isAI ? 'ğŸ¤–' : 'ğŸ·ï¸',
                      label: isAI ? 'AI' : 'í•´ì‹œíƒœê·¸'
                    };
                    
                    setComments(prev => [newComment, ...prev]);
                    setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 50 }));
                    addLog(`âœ… [${isAI ? 'ğŸ¤– AI' : 'ğŸ·ï¸ í•´ì‹œíƒœê·¸'}] ${isAI ? 'AI ìƒì„±' : '#' + hashtag.tag} - ëŒ“ê¸€ ì‘ì„± ì™„ë£Œ!`, 'success');
                    addLog(`ğŸ”— ëŒ“ê¸€ ë§í¬: ${commentLink}`, 'info');
                  } catch (error) {
                    addLog(`âŒ ëŒ“ê¸€ ì‘ì„± ì‹¤íŒ¨: ${error.message}`, 'error');
                  }
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì‹œê°„ ì—…ë°ì´íŠ¸
                setLastCheck(prev => ({
                  ...prev,
                  [hashtag.id]: Date.now()
                }));
                
              } catch (error) {
                addLog(`âŒ #${hashtag.tag} ì²˜ë¦¬ ì‹¤íŒ¨: ${error.message}`, 'error');
              }
            }
            
            // í‚¤ì›Œë“œ ê²€ìƒ‰
            const activeKeywords = keywords.filter(k => k.enabled);
            
            for (const keyword of activeKeywords) {
              try {
                addLog(`ğŸ” í‚¤ì›Œë“œ "${keyword.term}" ê²€ìƒ‰ ì¤‘...`, 'info');
                
                // V5.0 Lite: ë°°ì¹˜ í¬ê¸° ì œí•œ ì ìš©
                const batchSize = optimization.enabled && optimization.batchSize ? optimization.batchSize : 5;
                
                // í‚¤ì›Œë“œë¡œ ì˜ìƒ ê²€ìƒ‰
                const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(keyword.term)}&type=video&order=date&maxResults=${batchSize}&key=${YOUTUBE_API_KEY}`;
                const searchResponse = await fetch(searchUrl);
                const searchData = await searchResponse.json();
                setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 100 }));
                
                if (!searchData.items || searchData.items.length === 0) {
                  addLog(`ğŸ“¹ "${keyword.term}": ìƒˆ ì˜ìƒ ì—†ìŒ`, 'info');
                  continue;
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì´í›„ ìƒˆ ì˜ìƒë§Œ í•„í„°ë§
                const lastCheckTime = lastCheck[keyword.id] || 0;
                let newVideos = searchData.items.filter(item => {
                  const publishedAt = new Date(item.snippet.publishedAt).getTime();
                  return publishedAt > lastCheckTime;
                });
                
                // ì¡°íšŒìˆ˜ í•„í„° (videoIdë¡œ ìƒì„¸ ì •ë³´ ê°€ì ¸ì™€ì•¼ í•¨)
                if (keyword.minViews > 0 && newVideos.length > 0) {
                  const videoIds = newVideos.map(v => v.id.videoId).join(',');
                  const videoUrl = `https://www.googleapis.com/youtube/v3/videos?part=statistics&id=${videoIds}&key=${YOUTUBE_API_KEY}`;
                  const videoResponse = await fetch(videoUrl);
                  const videoData = await videoResponse.json();
                  setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 1 }));
                  
                  // ì¡°íšŒìˆ˜ í•„í„°ë§
                  newVideos = newVideos.filter(video => {
                    const videoStats = videoData.items.find(v => v.id === video.id.videoId);
                    if (!videoStats) return false;
                    return parseInt(videoStats.statistics.viewCount) >= keyword.minViews;
                  });
                }
                
                if (newVideos.length === 0) {
                  addLog(`ğŸ“¹ "${keyword.term}": ì¡°ê±´ ë§ëŠ” ìƒˆ ì˜ìƒ ì—†ìŒ (ë§ˆì§€ë§‰ ì²´í¬: ${new Date(lastCheckTime).toLocaleString('ko-KR')})`, 'info');
                  continue;
                }
                
                // V5.0 Lite: ìµœì í™” í•„í„°ë§
                let skippedCount = 0;
                let optimizedVideos = [];
                
                for (const video of newVideos) {
                  const videoId = video.id.videoId;
                  const publishedAt = video.snippet.publishedAt;
                  
                  // ğŸ†• ì˜ìƒì´ ë„ˆë¬´ ì˜¤ë˜ë˜ì—ˆëŠ”ì§€ ì²´í¬
                  if (isVideoTooOld(publishedAt)) {
                    const ageInHours = Math.floor((Date.now() - new Date(publishedAt).getTime()) / (1000 * 60 * 60));
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì˜¤ë˜ëœ ì˜ìƒ (${ageInHours}ì‹œê°„ ì „)`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  // ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoCommented(videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ ëŒ“ê¸€ ì‘ì„±í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  // ì´ë¯¸ ì²´í¬í•œ ì˜ìƒ ê±´ë„ˆë›°ê¸°
                  if (isVideoChecked(keyword.id, videoId)) {
                    addLog(`â­ï¸ ê±´ë„ˆëœ€: ì´ë¯¸ í™•ì¸í•œ ì˜ìƒ`, 'info');
                    skippedCount++;
                    setApiUsage(prev => ({ ...prev, saved: prev.saved + 150 }));
                    continue;
                  }
                  
                  optimizedVideos.push(video);
                  markVideoChecked(keyword.id, videoId);
                }
                
                if (skippedCount > 0) {
                  addLog(`ğŸ’¡ ìµœì í™”: ${skippedCount}ê°œ ì˜ìƒ ê±´ë„ˆëœ€ (API ${skippedCount * 150} units ì ˆì•½!)`, 'success');
                }
                
                if (optimizedVideos.length === 0) {
                  addLog(`ğŸ“¹ "${keyword.term}": ìƒˆ ì˜ìƒ ì—†ìŒ (ìµœì í™” í•„í„°ë§ í›„)`, 'info');
                  continue;
                }
                
                addLog(`ğŸ“¹ "${keyword.term}": ${optimizedVideos.length}ê°œ ìƒˆ ì˜ìƒ ë°œê²¬!`, 'success');
                
                // ìƒˆ ì˜ìƒì— ëŒ“ê¸€ ì‘ì„±
                for (const video of optimizedVideos) {
                  // AI ëŒ“ê¸€ ìƒì„± ì‹œë„ ë˜ëŠ” íŒ¨í„´ ì‚¬ìš©
                  let commentText;
                  let isAI = false;
                  
                  if (aiEnabled) {
                    commentText = await generateAIComment(video.snippet.title, video.snippet.description);
                    if (commentText) {
                      isAI = true;
                    } else {
                      // AI ì‹¤íŒ¨ ì‹œ íŒ¨í„´ ì‚¬ìš©
                      commentText = keyword.patterns[Math.floor(Math.random() * keyword.patterns.length)];
                    }
                  } else {
                    commentText = keyword.patterns[Math.floor(Math.random() * keyword.patterns.length)];
                  }
                  
                  addLog(`ğŸ’¬ ëŒ“ê¸€ ì‘ì„± ì¤‘: "${commentText}"`, 'info');
                  
                  try {
                    const result = await youtubeAPI.postComment(video.id.videoId, commentText);
                    
                    const commentLink = `https://www.youtube.com/watch?v=${video.id.videoId}&lc=${result.id}`;
                    
                    const newComment = {
                      id: result.id,
                      videoId: video.id.videoId,
                      videoTitle: video.snippet.title,
                      text: commentText,
                      timestamp: new Date().toISOString(),
                      channel: video.snippet.channelTitle,
                      // ì¶œì²˜ ì •ë³´
                      source: isAI ? 'ai' : 'keyword',
                      sourceDetail: isAI ? 'AI ìƒì„±' : `"${keyword.term}"`,
                      method: isAI ? 'ai-generated' : 'keyword-search',
                      icon: isAI ? 'ğŸ¤–' : 'ğŸ”',
                      label: isAI ? 'AI' : 'í‚¤ì›Œë“œ'
                    };
                    
                    setComments(prev => [newComment, ...prev]);
                    setApiUsage(prev => ({ ...prev, youtube: prev.youtube + 50 }));
                    addLog(`âœ… [${isAI ? 'ğŸ¤– AI' : 'ğŸ” í‚¤ì›Œë“œ'}] ${isAI ? 'AI ìƒì„±' : '"' + keyword.term + '"'} - ëŒ“ê¸€ ì‘ì„± ì™„ë£Œ!`, 'success');
                    addLog(`ğŸ”— ëŒ“ê¸€ ë§í¬: ${commentLink}`, 'info');
                  } catch (error) {
                    addLog(`âŒ ëŒ“ê¸€ ì‘ì„± ì‹¤íŒ¨: ${error.message}`, 'error');
                  }
                }
                
                // ë§ˆì§€ë§‰ ì²´í¬ ì‹œê°„ ì—…ë°ì´íŠ¸
                setLastCheck(prev => ({
                  ...prev,
                  [keyword.id]: Date.now()
                }));
                
              } catch (error) {
                addLog(`âŒ "${keyword.term}" ì²˜ë¦¬ ì‹¤íŒ¨: ${error.message}`, 'error');
              }
            }
          };
          
          const startMonitoring = async () => {
            if (!isAuthenticated) {
              addLog('âš ï¸ ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”', 'warning');
              return;
            }
            
            const activeChannels = channels.filter(c => c.enabled);
            const activeHashtags = hashtags.filter(h => h.enabled);
            const activeKeywords = keywords.filter(k => k.enabled);
            
            if (activeChannels.length === 0 && activeHashtags.length === 0 && activeKeywords.length === 0) {
              addLog('âš ï¸ í™œì„±í™”ëœ ì±„ë„, í•´ì‹œíƒœê·¸ ë˜ëŠ” í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤', 'warning');
              return;
            }
            
            setIsMonitoring(true);
            addLog(`ğŸš€ ëª¨ë‹ˆí„°ë§ ì‹œì‘! (${monitoringInterval}ë¶„ ê°„ê²©)`, 'success');
            if (activeChannels.length > 0) {
              addLog(`ğŸ“º ì±„ë„: ${activeChannels.length}ê°œ`, 'info');
            }
            if (activeHashtags.length > 0) {
              addLog(`ğŸ·ï¸ í•´ì‹œíƒœê·¸: ${activeHashtags.length}ê°œ`, 'info');
            }
            if (activeKeywords.length > 0) {
              addLog(`ğŸ” í‚¤ì›Œë“œ: ${activeKeywords.length}ê°œ`, 'info');
            }
            
            // ì¦‰ì‹œ í•œ ë²ˆ ì‹¤í–‰
            await checkNewVideos();
            
            // ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰
            monitoringTimerRef.current = setInterval(() => {
              checkNewVideos();
            }, monitoringInterval * 60 * 1000);
          };
          
          const stopMonitoring = () => {
            if (monitoringTimerRef.current) {
              clearInterval(monitoringTimerRef.current);
              monitoringTimerRef.current = null;
            }
            setIsMonitoring(false);
            addLog('â¹ï¸ ëª¨ë‹ˆí„°ë§ ì •ì§€ë¨', 'info');
          };
          
          // UI - Login Screen
          if (!isAuthenticated) {
            return (
              <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-red-500 via-purple-500 to-pink-500">
                <div className="bg-white rounded-3xl shadow-2xl p-12 max-w-md w-full mx-4">
                  <div className="text-center mb-8">
                    <div className="text-6xl mb-4">ğŸ¤–</div>
                    <h1 className="text-3xl font-bold mb-2">YouTube Auto Manager</h1>
                    <p className="text-sm bg-pink-100 text-pink-800 px-3 py-1 rounded-full inline-block mb-4">PRO - Fetch Version</p>
                    <p className="text-sm text-gray-500">âœ¨ Fetch ê¸°ë°˜ API</p>
                  </div>
                  
                  <button
                    onClick={handleLogin}
                    className="w-full bg-gradient-to-r from-red-500 to-pink-500 text-white py-4 rounded-xl font-bold text-lg hover:shadow-xl transition-all"
                  >
                    ğŸ”‘ Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
                  </button>
                  
                  <div className="mt-8 bg-gray-50 rounded-xl p-6">
                    <p className="font-bold mb-3 text-sm">ğŸ¯ ê¸°ëŠ¥:</p>
                    <ul className="text-sm space-y-2 text-gray-700">
                      <li>âœ… Fetch ê¸°ë°˜ YouTube API</li>
                      <li>âœ… Google Identity Services</li>
                      <li>âœ… ì‹¤ì œ ëŒ“ê¸€ ì‘ì„±</li>
                      <li>ğŸ“Š API ì‚¬ìš©ëŸ‰ ì¶”ì </li>
                    </ul>
                  </div>
                </div>
              </div>
            );
          }
          
          // UI - Main App
          return (
            <div className="min-h-screen bg-gray-50">
              {/* Header */}
              <div className="bg-white shadow-sm border-b sticky top-0 z-50">
                <div className="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">âš¡</span>
                    <h1 className="text-xl font-bold">YouTube Manager <span className="text-xs bg-green-100 text-green-800 px-2 py-1 rounded font-bold">V5.0 Lite</span></h1>
                  </div>
                  <div className="flex items-center gap-4">
                    {isMonitoring && (
                      <div className="flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full animate-pulse">
                        <span className="w-2 h-2 bg-green-500 rounded-full"></span>
                        <span className="text-xs font-bold">ëª¨ë‹ˆí„°ë§ ì¤‘</span>
                      </div>
                    )}
                    <span className="text-sm text-gray-600">API: {apiUsage.youtube} units</span>
                    {user && (
                      <>
                        <img src={user.image} alt={user.name} className="w-8 h-8 rounded-full" />
                        <span className="text-sm font-medium">{user.name}</span>
                      </>
                    )}
                    <button onClick={handleLogout} className="text-red-500 text-sm hover:underline">ë¡œê·¸ì•„ì›ƒ</button>
                  </div>
                </div>
                
                {/* Tabs */}
                <div className="max-w-7xl mx-auto px-4 flex gap-2 overflow-x-auto">
                  {[
                    { id: 'home', label: 'ğŸ  í™ˆ' },
                    { id: 'channels', label: 'ğŸ“º ì±„ë„' },
                    { id: 'hashtags', label: 'ğŸ·ï¸ í•´ì‹œíƒœê·¸' },
                    { id: 'keywords', label: 'ğŸ” í‚¤ì›Œë“œ' },
                    { id: 'ai', label: 'ğŸ¤– AI' },
                    { id: 'optimization', label: 'âš¡ ìµœì í™”' },
                    { id: 'comments', label: 'ğŸ’¬ ëŒ“ê¸€' },
                    { id: 'logs', label: 'ğŸ“‹ ë¡œê·¸' }
                  ].map(tab => (
                    <button
                      key={tab.id}
                      onClick={() => setCurrentTab(tab.id)}
                      className={`px-4 py-2 border-b-2 transition-colors whitespace-nowrap ${
                        currentTab === tab.id
                          ? 'border-red-500 text-red-500 font-bold'
                          : 'border-transparent text-gray-600 hover:bg-gray-50'
                      }`}
                    >
                      {tab.label}
                    </button>
                  ))}
                </div>
              </div>

              {/* Content */}
              <div className="max-w-7xl mx-auto p-6">
                {/* Home Tab */}
                {currentTab === 'home' && (
                  <div className="space-y-6">
                    <div className="bg-white rounded-xl p-6 shadow">
                      <div className="flex items-center justify-between mb-4">
                        <h2 className="text-xl font-bold">ğŸ¯ ëª¨ë‹ˆí„°ë§</h2>
                        {isMonitoring ? (
                          <div className="flex items-center gap-2 bg-green-100 text-green-800 px-4 py-2 rounded-full">
                            <span className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
                            <span className="text-sm font-bold">ì‹¤í–‰ ì¤‘</span>
                          </div>
                        ) : (
                          <div className="flex items-center gap-2 bg-gray-100 text-gray-600 px-4 py-2 rounded-full">
                            <span className="w-3 h-3 bg-gray-400 rounded-full"></span>
                            <span className="text-sm font-bold">ëŒ€ê¸° ì¤‘</span>
                          </div>
                        )}
                      </div>
                      
                      {/* ìƒíƒœ ì •ë³´ */}
                      <div className="mb-4 p-4 bg-gray-50 rounded-lg">
                        <div className="grid grid-cols-3 gap-3 text-sm">
                          <div>
                            <span className="text-gray-600">ğŸ“º í™œì„± ì±„ë„:</span>
                            <span className="ml-2 font-bold text-blue-600">{channels.filter(c => c.enabled).length}ê°œ</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ·ï¸ í™œì„± í•´ì‹œíƒœê·¸:</span>
                            <span className="ml-2 font-bold text-green-600">{hashtags.filter(h => h.enabled).length}ê°œ</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ” í™œì„± í‚¤ì›Œë“œ:</span>
                            <span className="ml-2 font-bold text-purple-600">{keywords.filter(k => k.enabled).length}ê°œ</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ¤– AI ëª¨ë“œ:</span>
                            <span className="ml-2 font-bold">{aiEnabled ? 'ğŸŸ¢ í™œì„±í™”' : 'âšª ë¹„í™œì„±í™”'}</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ’¬ ì˜¤ëŠ˜ ì‘ì„±:</span>
                            <span className="ml-2 font-bold text-green-600">{comments.filter(c => new Date(c.timestamp).toDateString() === new Date().toDateString()).length}ê°œ</span>
                          </div>
                          <div>
                            <span className="text-gray-600">â±ï¸ ìƒíƒœ:</span>
                            <span className="ml-2 font-bold">{isMonitoring ? 'ğŸŸ¢ ì‹¤í–‰ ì¤‘' : 'âšª ëŒ€ê¸° ì¤‘'}</span>
                          </div>
                        </div>
                        
                        <div className="mt-3 pt-3 border-t border-gray-200 grid grid-cols-3 gap-3 text-sm">
                          <div>
                            <span className="text-gray-600">ğŸ“Š YouTube API:</span>
                            <span className="ml-2 font-bold text-orange-600">{apiUsage.youtube} units</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ¤– AI API:</span>
                            <span className="ml-2 font-bold text-blue-600">{apiUsage.anthropic} calls</span>
                          </div>
                          <div>
                            <span className="text-gray-600">ğŸ’¡ ì ˆì•½:</span>
                            <span className="ml-2 font-bold text-green-600">{apiUsage.saved} units âš¡</span>
                          </div>
                        </div>
                        
                        {/* ì¶œì²˜ë³„ í†µê³„ */}
                        {comments.length > 0 && (
                          <div className="mt-3 pt-3 border-t border-gray-200">
                            <div className="text-xs font-bold text-gray-700 mb-2">ğŸ“Š ëŒ“ê¸€ ì¶œì²˜ë³„ í†µê³„:</div>
                            <div className="grid grid-cols-4 gap-2 text-xs">
                              <div className="flex items-center gap-2">
                                <span className="text-gray-600">ğŸ“º ì±„ë„:</span>
                                <span className="font-bold text-blue-600">
                                  {comments.filter(c => c.source === 'channel').length}ê°œ
                                  ({Math.round(comments.filter(c => c.source === 'channel').length / comments.length * 100)}%)
                                </span>
                              </div>
                              <div className="flex items-center gap-2">
                                <span className="text-gray-600">ğŸ·ï¸ í•´ì‹œíƒœê·¸:</span>
                                <span className="font-bold text-green-600">
                                  {comments.filter(c => c.source === 'hashtag').length}ê°œ
                                  ({Math.round(comments.filter(c => c.source === 'hashtag').length / comments.length * 100)}%)
                                </span>
                              </div>
                              <div className="flex items-center gap-2">
                                <span className="text-gray-600">ğŸ” í‚¤ì›Œë“œ:</span>
                                <span className="font-bold text-purple-600">
                                  {comments.filter(c => c.source === 'keyword').length}ê°œ
                                  ({Math.round(comments.filter(c => c.source === 'keyword').length / comments.length * 100)}%)
                                </span>
                              </div>
                              <div className="flex items-center gap-2">
                                <span className="text-gray-600">ğŸ¤– AI:</span>
                                <span className="font-bold text-pink-600">
                                  {comments.filter(c => c.source === 'ai').length}ê°œ
                                  ({Math.round(comments.filter(c => c.source === 'ai').length / comments.length * 100)}%)
                                </span>
                              </div>
                            </div>
                          </div>
                        )}
                      </div>
                      
                      {/* ëª¨ë‹ˆí„°ë§ ê°„ê²© ì„¤ì • */}
                      {!isMonitoring && (
                        <div className="mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                          <label className="block text-sm font-bold text-gray-700 mb-2">
                            â±ï¸ ì²´í¬ ê°„ê²© ì„¤ì •
                          </label>
                          <div className="flex items-center gap-3">
                            <input
                              type="range"
                              min="1"
                              max="60"
                              value={monitoringInterval}
                              onChange={(e) => setMonitoringInterval(parseInt(e.target.value))}
                              className="flex-1"
                            />
                            <span className="text-lg font-bold text-blue-600 w-24 text-right">
                              {monitoringInterval}ë¶„
                            </span>
                          </div>
                          <div className="text-xs text-gray-600 mt-2">
                            ğŸ’¡ ì¶”ì²œ: 5-10ë¶„ (ë„ˆë¬´ ì§§ìœ¼ë©´ API í• ë‹¹ëŸ‰ ì†Œëª¨)
                          </div>
                        </div>
                      )}
                      
                      <button
                        onClick={isMonitoring ? stopMonitoring : startMonitoring}
                        className={`w-full py-3 rounded-xl font-bold transition-all ${
                          isMonitoring
                            ? 'bg-yellow-500 text-white hover:bg-yellow-600 hover:shadow-lg'
                            : 'bg-red-500 text-white hover:bg-red-600 hover:shadow-lg transform hover:scale-[1.02]'
                        }`}
                      >
                        {isMonitoring ? 'â¹ï¸ ëª¨ë‹ˆí„°ë§ ì •ì§€' : 'ğŸš€ ëª¨ë‹ˆí„°ë§ ì‹œì‘'}
                      </button>
                      
                      {isMonitoring && (
                        <div className="mt-3 text-sm text-center text-gray-600">
                          â° {monitoringInterval}ë¶„ë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒˆ ì˜ìƒì„ í™•ì¸í•©ë‹ˆë‹¤
                        </div>
                      )}
                    </div>
                    
                    <div className="grid grid-cols-3 gap-4">
                      <div className="bg-white rounded-xl p-6 shadow text-center">
                        <div className="text-3xl mb-2">ğŸ“º</div>
                        <div className="text-2xl font-bold">{channels.filter(c => c.enabled).length}</div>
                        <div className="text-sm text-gray-600">í™œì„± ì±„ë„</div>
                      </div>
                      <div className="bg-white rounded-xl p-6 shadow text-center">
                        <div className="text-3xl mb-2">ğŸ’¬</div>
                        <div className="text-2xl font-bold">{comments.length}</div>
                        <div className="text-sm text-gray-600">ì‘ì„± ëŒ“ê¸€</div>
                      </div>
                      <div className="bg-white rounded-xl p-6 shadow text-center">
                        <div className="text-3xl mb-2">ğŸ“Š</div>
                        <div className="text-2xl font-bold">{apiUsage.youtube}</div>
                        <div className="text-sm text-gray-600">API ì‚¬ìš©ëŸ‰</div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Channels Tab */}
                {currentTab === 'channels' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-xl font-bold">ğŸ“º ì±„ë„ ê´€ë¦¬</h2>
                      <button
                        onClick={addChannel}
                        className="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600"
                      >
                        + ì±„ë„ ì¶”ê°€
                      </button>
                    </div>
                    
                    {channels.length === 0 ? (
                      <div className="text-center py-12 text-gray-400">
                        <p className="text-5xl mb-4">ğŸ“º</p>
                        <p>ë“±ë¡ëœ ì±„ë„ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        <p className="text-sm mt-2">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì±„ë„ì„ ì¶”ê°€í•˜ì„¸ìš”</p>
                      </div>
                    ) : (
                      <div className="space-y-3">
                        {channels.map(channel => (
                          <div key={channel.id} className="border rounded-lg p-4">
                            <div className="flex items-center gap-4 mb-3">
                              <img src={channel.thumbnail} alt={channel.name} className="w-12 h-12 rounded-full" />
                              <div className="flex-1">
                                <div className="font-bold">{channel.name}</div>
                                <div className="text-sm text-gray-600">{parseInt(channel.subscribers).toLocaleString()} êµ¬ë…ì</div>
                              </div>
                              <label className="flex items-center gap-2">
                                <input
                                  type="checkbox"
                                  checked={channel.enabled}
                                  onChange={() => toggleChannel(channel.id)}
                                />
                                <span className="text-sm">í™œì„±í™”</span>
                              </label>
                              <button
                                onClick={() => removeChannel(channel.id)}
                                className="text-red-500 hover:text-red-700 px-3 py-1"
                              >
                                ğŸ—‘ï¸
                              </button>
                            </div>
                            
                            {/* ëŒ“ê¸€ íŒ¨í„´ ê´€ë¦¬ */}
                            <div className="border-t pt-3 mt-3">
                              <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-bold text-gray-700">ğŸ’¬ ëŒ“ê¸€ íŒ¨í„´ ({channel.patterns.length}ê°œ)</span>
                                <button
                                  onClick={() => {
                                    const newPattern = prompt('ìƒˆ ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš”:');
                                    if (newPattern && newPattern.trim()) {
                                      setChannels(prev => prev.map(c => 
                                        c.id === channel.id 
                                          ? { ...c, patterns: [...c.patterns, newPattern.trim()] }
                                          : c
                                      ));
                                      addLog(`âœ… íŒ¨í„´ ì¶”ê°€ë¨: "${newPattern.trim()}"`, 'success');
                                    }
                                  }}
                                  className="text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                                >
                                  + ì¶”ê°€
                                </button>
                              </div>
                              
                              <div className="space-y-2 max-h-40 overflow-y-auto">
                                {channel.patterns.map((pattern, idx) => (
                                  <div key={idx} className="flex items-center gap-2 bg-gray-50 p-2 rounded text-sm">
                                    <span className="flex-1 text-gray-700">{pattern}</span>
                                    <button
                                      onClick={() => {
                                        if (confirm(`"${pattern}" íŒ¨í„´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                                          setChannels(prev => prev.map(c =>
                                            c.id === channel.id
                                              ? { ...c, patterns: c.patterns.filter((_, i) => i !== idx) }
                                              : c
                                          ));
                                          addLog(`âœ… íŒ¨í„´ ì‚­ì œë¨`, 'info');
                                        }
                                      }}
                                      className="text-red-500 hover:text-red-700 text-xs"
                                    >
                                      ì‚­ì œ
                                    </button>
                                  </div>
                                ))}
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {/* Hashtags Tab */}
                {currentTab === 'hashtags' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-xl font-bold">ğŸ·ï¸ í•´ì‹œíƒœê·¸ ê´€ë¦¬</h2>
                      <button
                        onClick={addHashtag}
                        className="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600"
                      >
                        + í•´ì‹œíƒœê·¸ ì¶”ê°€
                      </button>
                    </div>
                    
                    {hashtags.length === 0 ? (
                      <div className="text-center py-12 text-gray-400">
                        <p className="text-5xl mb-4">ğŸ·ï¸</p>
                        <p>ë“±ë¡ëœ í•´ì‹œíƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        <p className="text-sm mt-2">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ í•´ì‹œíƒœê·¸ë¥¼ ì¶”ê°€í•˜ì„¸ìš”</p>
                      </div>
                    ) : (
                      <div className="space-y-3">
                        {hashtags.map(hashtag => (
                          <div key={hashtag.id} className="border rounded-lg p-4">
                            <div className="flex items-center gap-4 mb-3">
                              <div className="flex-1">
                                <div className="font-bold text-lg text-green-600">#{hashtag.tag}</div>
                                <div className="text-xs text-gray-500 mt-1">ì¶”ê°€ì¼: {new Date(hashtag.addedAt).toLocaleDateString('ko-KR')}</div>
                              </div>
                              <label className="flex items-center gap-2">
                                <input
                                  type="checkbox"
                                  checked={hashtag.enabled}
                                  onChange={() => toggleHashtag(hashtag.id)}
                                />
                                <span className="text-sm">í™œì„±í™”</span>
                              </label>
                              <button
                                onClick={() => removeHashtag(hashtag.id)}
                                className="text-red-500 hover:text-red-700 px-3 py-1"
                              >
                                ğŸ—‘ï¸
                              </button>
                            </div>
                            
                            {/* ëŒ“ê¸€ íŒ¨í„´ ê´€ë¦¬ */}
                            <div className="border-t pt-3 mt-3">
                              <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-bold text-gray-700">ğŸ’¬ ëŒ“ê¸€ íŒ¨í„´ ({hashtag.patterns.length}ê°œ)</span>
                                <button
                                  onClick={() => {
                                    const newPattern = prompt('ìƒˆ ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš”:');
                                    if (newPattern && newPattern.trim()) {
                                      setHashtags(prev => prev.map(h => 
                                        h.id === hashtag.id 
                                          ? { ...h, patterns: [...h.patterns, newPattern.trim()] }
                                          : h
                                      ));
                                      addLog(`âœ… íŒ¨í„´ ì¶”ê°€ë¨: "${newPattern.trim()}"`, 'success');
                                    }
                                  }}
                                  className="text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                                >
                                  + ì¶”ê°€
                                </button>
                              </div>
                              
                              <div className="space-y-2 max-h-40 overflow-y-auto">
                                {hashtag.patterns.map((pattern, idx) => (
                                  <div key={idx} className="flex items-center gap-2 bg-gray-50 p-2 rounded text-sm">
                                    <span className="flex-1 text-gray-700">{pattern}</span>
                                    <button
                                      onClick={() => {
                                        if (confirm(`"${pattern}" íŒ¨í„´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                                          setHashtags(prev => prev.map(h =>
                                            h.id === hashtag.id
                                              ? { ...h, patterns: h.patterns.filter((_, i) => i !== idx) }
                                              : h
                                          ));
                                          addLog(`âœ… íŒ¨í„´ ì‚­ì œë¨`, 'info');
                                        }
                                      }}
                                      className="text-red-500 hover:text-red-700 text-xs"
                                    >
                                      ì‚­ì œ
                                    </button>
                                  </div>
                                ))}
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {/* Keywords Tab */}
                {currentTab === 'keywords' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-xl font-bold">ğŸ” í‚¤ì›Œë“œ ê´€ë¦¬</h2>
                      <button
                        onClick={addKeyword}
                        className="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600"
                      >
                        + í‚¤ì›Œë“œ ì¶”ê°€
                      </button>
                    </div>
                    
                    {keywords.length === 0 ? (
                      <div className="text-center py-12 text-gray-400">
                        <p className="text-5xl mb-4">ğŸ”</p>
                        <p>ë“±ë¡ëœ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        <p className="text-sm mt-2">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”</p>
                      </div>
                    ) : (
                      <div className="space-y-3">
                        {keywords.map(keyword => (
                          <div key={keyword.id} className="border rounded-lg p-4">
                            <div className="flex items-center gap-4 mb-3">
                              <div className="flex-1">
                                <div className="font-bold text-lg text-purple-600">"{keyword.term}"</div>
                                <div className="text-xs text-gray-500 mt-1">
                                  ì¡°íšŒìˆ˜: {keyword.minViews > 0 ? `${keyword.minViews.toLocaleString()}+ ì´ìƒ` : 'ì œí•œì—†ìŒ'} | 
                                  ì¶”ê°€ì¼: {new Date(keyword.addedAt).toLocaleDateString('ko-KR')}
                                </div>
                              </div>
                              <label className="flex items-center gap-2">
                                <input
                                  type="checkbox"
                                  checked={keyword.enabled}
                                  onChange={() => toggleKeyword(keyword.id)}
                                />
                                <span className="text-sm">í™œì„±í™”</span>
                              </label>
                              <button
                                onClick={() => removeKeyword(keyword.id)}
                                className="text-red-500 hover:text-red-700 px-3 py-1"
                              >
                                ğŸ—‘ï¸
                              </button>
                            </div>
                            
                            {/* ëŒ“ê¸€ íŒ¨í„´ ê´€ë¦¬ */}
                            <div className="border-t pt-3 mt-3">
                              <div className="flex items-center justify-between mb-2">
                                <span className="text-sm font-bold text-gray-700">ğŸ’¬ ëŒ“ê¸€ íŒ¨í„´ ({keyword.patterns.length}ê°œ)</span>
                                <button
                                  onClick={() => {
                                    const newPattern = prompt('ìƒˆ ëŒ“ê¸€ íŒ¨í„´ì„ ì…ë ¥í•˜ì„¸ìš”:');
                                    if (newPattern && newPattern.trim()) {
                                      setKeywords(prev => prev.map(k => 
                                        k.id === keyword.id 
                                          ? { ...k, patterns: [...k.patterns, newPattern.trim()] }
                                          : k
                                      ));
                                      addLog(`âœ… íŒ¨í„´ ì¶”ê°€ë¨: "${newPattern.trim()}"`, 'success');
                                    }
                                  }}
                                  className="text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
                                >
                                  + ì¶”ê°€
                                </button>
                              </div>
                              
                              <div className="space-y-2 max-h-40 overflow-y-auto">
                                {keyword.patterns.map((pattern, idx) => (
                                  <div key={idx} className="flex items-center gap-2 bg-gray-50 p-2 rounded text-sm">
                                    <span className="flex-1 text-gray-700">{pattern}</span>
                                    <button
                                      onClick={() => {
                                        if (confirm(`"${pattern}" íŒ¨í„´ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                                          setKeywords(prev => prev.map(k =>
                                            k.id === keyword.id
                                              ? { ...k, patterns: k.patterns.filter((_, i) => i !== idx) }
                                              : k
                                          ));
                                          addLog(`âœ… íŒ¨í„´ ì‚­ì œë¨`, 'info');
                                        }
                                      }}
                                      className="text-red-500 hover:text-red-700 text-xs"
                                    >
                                      ì‚­ì œ
                                    </button>
                                  </div>
                                ))}
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {/* AI Tab */}
                {currentTab === 'ai' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <h2 className="text-xl font-bold mb-4">ğŸ¤– AI ëŒ“ê¸€ ì„¤ì •</h2>
                    
                    {/* API í‚¤ ì„¤ì • */}
                    <div className="mb-6 p-4 bg-blue-50 rounded-lg border-2 border-blue-200">
                      <h3 className="font-bold text-lg mb-2">ğŸ”‘ Anthropic API í‚¤</h3>
                      <p className="text-sm text-gray-600 mb-3">
                        AI ëŒ“ê¸€ ìƒì„±ì„ ìœ„í•´ Anthropic API í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. 
                        <a href="https://console.anthropic.com" target="_blank" className="text-blue-600 hover:underline ml-1">
                          ì—¬ê¸°ì„œ ë°œê¸‰ë°›ìœ¼ì„¸ìš” â†’
                        </a>
                      </p>
                      <div className="flex gap-2">
                        <input
                          type="password"
                          value={anthropicApiKey}
                          onChange={(e) => setAnthropicApiKey(e.target.value)}
                          placeholder="sk-ant-api03-xxxxxxxxxxxxxxxx..."
                          className="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
                        />
                        <button
                          onClick={() => {
                            if (anthropicApiKey.trim()) {
                              alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                            } else {
                              alert('API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                            }
                          }}
                          className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 text-sm font-bold"
                        >
                          ì €ì¥
                        </button>
                      </div>
                      <div className="mt-2 text-xs">
                        {anthropicApiKey ? (
                          <span className="text-green-600 font-bold">âœ… API í‚¤ ì„¤ì •ë¨ (sk-ant-...{anthropicApiKey.slice(-4)})</span>
                        ) : (
                          <span className="text-orange-600 font-bold">âš ï¸ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”</span>
                        )}
                      </div>
                      <div className="mt-3 p-3 bg-white rounded border border-blue-200">
                        <p className="text-xs text-gray-700 font-bold mb-1">ğŸ’° ë¹„ìš© ì•ˆë‚´:</p>
                        <ul className="text-xs text-gray-600 space-y-1">
                          <li>â€¢ $5 ë¬´ë£Œ í¬ë ˆë”§ ì œê³µ</li>
                          <li>â€¢ ëŒ“ê¸€ 1ê°œ: ì•½ $0.0003 (0.3ì›)</li>
                          <li>â€¢ 10,000 ëŒ“ê¸€: ì•½ $3 (3,000ì›)</li>
                          <li>â€¢ ë§¤ìš° ì €ë ´í•©ë‹ˆë‹¤! ğŸ˜Š</li>
                        </ul>
                      </div>
                    </div>
                    
                    {/* AI í™œì„±í™” í† ê¸€ */}
                    <div className="mb-6 p-4 bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg border-2 border-pink-200">
                      <div className="flex items-center justify-between mb-3">
                        <div>
                          <h3 className="font-bold text-lg">ğŸ¤– AI ëŒ“ê¸€ ìƒì„±</h3>
                          <p className="text-sm text-gray-600 mt-1">ì˜ìƒ ì œëª©ê³¼ ë‚´ìš©ì„ ë¶„ì„í•´ì„œ ìì—°ìŠ¤ëŸ¬ìš´ ëŒ“ê¸€ì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤</p>
                        </div>
                        <label className="relative inline-flex items-center cursor-pointer">
                          <input
                            type="checkbox"
                            checked={aiEnabled}
                            onChange={(e) => setAiEnabled(e.target.checked)}
                            className="sr-only peer"
                          />
                          <div className="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-pink-500"></div>
                        </label>
                      </div>
                      <div className="text-xs text-gray-500">
                        {aiEnabled ? (
                          <span className="text-green-600 font-bold">âœ… AI ëŒ“ê¸€ ìƒì„± í™œì„±í™”ë¨</span>
                        ) : (
                          <span className="text-gray-600">âšª ë¹„í™œì„±í™” - ìˆ˜ë™ íŒ¨í„´ ì‚¬ìš©</span>
                        )}
                      </div>
                    </div>
                    
                    {/* AI ìŠ¤íƒ€ì¼ ì„¤ì • */}
                    <div className="mb-6">
                      <h3 className="font-bold mb-3">ğŸ¨ ëŒ“ê¸€ ìŠ¤íƒ€ì¼</h3>
                      <div className="grid grid-cols-2 gap-3">
                        {[
                          { value: 'friendly', label: 'ì¹œê·¼í•¨', icon: 'ğŸ˜Š', desc: 'ë”°ëœ»í•˜ê³  ì¹œê·¼í•œ í†¤' },
                          { value: 'professional', label: 'ì „ë¬¸ì ', icon: 'ğŸ’¼', desc: 'ì •ì¤‘í•˜ê³  ì „ë¬¸ì ì¸ í†¤' },
                          { value: 'enthusiastic', label: 'ì—´ì •ì ', icon: 'ğŸ”¥', desc: 'í¥ë¯¸ì§„ì§„í•˜ê³  ì—´ì •ì ì¸ í†¤' },
                          { value: 'casual', label: 'í¸ì•ˆí•¨', icon: 'ğŸ˜', desc: 'ìì—°ìŠ¤ëŸ½ê³  í¸ì•ˆí•œ í†¤' }
                        ].map(style => (
                          <button
                            key={style.value}
                            onClick={() => setAiStyle(style.value)}
                            className={`p-4 rounded-lg border-2 text-left transition-all ${
                              aiStyle === style.value
                                ? 'border-pink-500 bg-pink-50'
                                : 'border-gray-200 hover:border-pink-300'
                            }`}
                          >
                            <div className="flex items-center gap-2 mb-1">
                              <span className="text-2xl">{style.icon}</span>
                              <span className="font-bold">{style.label}</span>
                            </div>
                            <div className="text-xs text-gray-600">{style.desc}</div>
                          </button>
                        ))}
                      </div>
                    </div>
                    
                    {/* AI ì‚¬ìš© í†µê³„ */}
                    <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
                      <h3 className="font-bold mb-3">ğŸ“Š AI ì‚¬ìš© í†µê³„</h3>
                      <div className="grid grid-cols-3 gap-4">
                        <div className="text-center">
                          <div className="text-3xl font-bold text-blue-600">{apiUsage.anthropic}</div>
                          <div className="text-xs text-gray-600">API í˜¸ì¶œ</div>
                        </div>
                        <div className="text-center">
                          <div className="text-3xl font-bold text-pink-600">{comments.filter(c => c.source === 'ai').length}</div>
                          <div className="text-xs text-gray-600">AI ëŒ“ê¸€</div>
                        </div>
                        <div className="text-center">
                          <div className="text-3xl font-bold text-green-600">
                            {comments.length > 0 ? Math.round(comments.filter(c => c.source === 'ai').length / comments.length * 100) : 0}%
                          </div>
                          <div className="text-xs text-gray-600">AI ë¹„ìœ¨</div>
                        </div>
                      </div>
                    </div>
                    
                    {/* AI ì°¸ê³ ì‚¬í•­ */}
                    <div className="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                      <h3 className="font-bold text-sm mb-2">ğŸ’¡ ì°¸ê³ ì‚¬í•­</h3>
                      <ul className="text-xs text-gray-700 space-y-1">
                        <li>â€¢ AIëŠ” ì˜ìƒ ì œëª©ê³¼ ì„¤ëª…ì„ ë¶„ì„í•´ì„œ ë§¥ë½ì— ë§ëŠ” ëŒ“ê¸€ì„ ìƒì„±í•©ë‹ˆë‹¤</li>
                        <li>â€¢ AI ìƒì„± ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ìˆ˜ë™ íŒ¨í„´ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤</li>
                        <li>â€¢ AI ëŒ“ê¸€ì€ 1-2ë¬¸ì¥, ìµœëŒ€ 50ì ì´ë‚´ë¡œ ìƒì„±ë©ë‹ˆë‹¤</li>
                        <li>â€¢ ìŠ¤íŒ¸ì´ë‚˜ ê´‘ê³ ë¡œ ì˜¤í•´ë°›ì§€ ì•Šë„ë¡ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ì„±ë©ë‹ˆë‹¤</li>
                      </ul>
                    </div>
                  </div>
                )}

                {/* Optimization Tab */}
                {currentTab === 'optimization' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <h2 className="text-xl font-bold mb-4">âš¡ ìµœì í™” ì„¤ì • (V5.0 Lite)</h2>
                    
                    {/* ì „ì²´ í™œì„±í™” */}
                    <div className="mb-6 p-4 bg-gradient-to-r from-yellow-50 to-green-50 rounded-lg border-2 border-yellow-200">
                      <div className="flex items-center justify-between mb-3">
                        <div>
                          <h3 className="font-bold text-lg">âš¡ ìµœì í™” ì‹œìŠ¤í…œ</h3>
                          <p className="text-sm text-gray-600 mt-1">API ì‚¬ìš©ëŸ‰ 70-80% ì ˆì•½</p>
                        </div>
                        <label className="relative inline-flex items-center cursor-pointer">
                          <input
                            type="checkbox"
                            checked={optimization.enabled}
                            onChange={(e) => setOptimization(prev => ({ ...prev, enabled: e.target.checked }))}
                            className="sr-only peer"
                          />
                          <div className="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-green-500"></div>
                        </label>
                      </div>
                      <div className="text-xs text-gray-500">
                        {optimization.enabled ? (
                          <span className="text-green-600 font-bold">âœ… ìµœì í™” í™œì„±í™”ë¨</span>
                        ) : (
                          <span className="text-gray-600">âšª ë¹„í™œì„±í™” - ì¼ë°˜ ëª¨ë“œ</span>
                        )}
                      </div>
                    </div>
                    
                    {/* ê°œë³„ ì„¤ì • */}
                    <div className="space-y-4 mb-6">
                      {/* ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸° */}
                      <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <div className="flex items-start justify-between mb-2">
                          <div className="flex-1">
                            <h4 className="font-bold">ğŸ¯ ì´ë¯¸ ëŒ“ê¸€ ë‹¨ ì˜ìƒ ê±´ë„ˆë›°ê¸°</h4>
                            <p className="text-sm text-gray-600 mt-1">
                              ë‚´ê°€ ì´ì „ì— ëŒ“ê¸€ ì‘ì„±í•œ ì˜ìƒì„ ìë™ìœ¼ë¡œ ê±´ë„ˆëœë‹ˆë‹¤
                            </p>
                            <div className="mt-2 text-xs text-gray-500">
                              â€¢ API ì ˆì•½: ì•½ 70%<br/>
                              â€¢ ì¤‘ë³µ ëŒ“ê¸€ ë°©ì§€<br/>
                              â€¢ ìŠ¤íŒ¸ìœ¼ë¡œ ë³´ì´ì§€ ì•ŠìŒ
                            </div>
                          </div>
                          <label className="relative inline-flex items-center cursor-pointer ml-4">
                            <input
                              type="checkbox"
                              checked={optimization.skipCommented}
                              onChange={(e) => setOptimization(prev => ({ ...prev, skipCommented: e.target.checked }))}
                              disabled={!optimization.enabled}
                              className="sr-only peer"
                            />
                            <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500 peer-disabled:opacity-50"></div>
                          </label>
                        </div>
                        <div className="mt-2 text-xs">
                          {optimization.skipCommented ? (
                            <span className="text-blue-600 font-bold">âœ… í™œì„±í™”</span>
                          ) : (
                            <span className="text-gray-500">âšª ë¹„í™œì„±í™”</span>
                          )}
                        </div>
                      </div>
                      
                      {/* ë°°ì¹˜ í¬ê¸° ì œí•œ */}
                      <div className="p-4 bg-green-50 rounded-lg border border-green-200">
                        <h4 className="font-bold mb-2">ğŸ“¦ ë°°ì¹˜ í¬ê¸° ì œí•œ</h4>
                        <p className="text-sm text-gray-600 mb-3">
                          í•œ ë²ˆì— í™•ì¸í•  ì˜ìƒ ìˆ˜ë¥¼ ì œí•œí•©ë‹ˆë‹¤
                        </p>
                        <div className="flex items-center gap-3">
                          <label className="text-sm font-bold">ìµœëŒ€ ì˜ìƒ ìˆ˜:</label>
                          <input
                            type="number"
                            value={optimization.batchSize}
                            onChange={(e) => setOptimization(prev => ({ ...prev, batchSize: parseInt(e.target.value) || 5 }))}
                            disabled={!optimization.enabled}
                            min="1"
                            max="50"
                            className="w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50"
                          />
                          <span className="text-sm text-gray-600">ê°œ</span>
                        </div>
                        <div className="mt-3 text-xs text-gray-500">
                          â€¢ ê¶Œì¥: 5ê°œ (ë¹ ë¥¸ ì²´í¬)<br/>
                          â€¢ ìƒˆ ì˜ìƒ ë°œê²¬ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨<br/>
                          â€¢ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ê°ì†Œ
                        </div>
                      </div>
                      
                      {/* ğŸ†• ì˜ìƒ ë‚˜ì´ ì œí•œ */}
                      <div className="p-4 bg-orange-50 rounded-lg border border-orange-200">
                        <h4 className="font-bold mb-2">â° ì˜ìƒ ë‚˜ì´ ì œí•œ (ì¤‘ìš”!)</h4>
                        <p className="text-sm text-gray-600 mb-3">
                          ì˜¤ëŠ˜ ì˜¬ë¼ì˜¨ ì˜ìƒë§Œ ëŒ“ê¸€ ì‘ì„±í•©ë‹ˆë‹¤
                        </p>
                        <div className="flex items-center gap-3">
                          <label className="text-sm font-bold">ìµœëŒ€ ë‚˜ì´:</label>
                          <input
                            type="number"
                            value={optimization.maxVideoAge}
                            onChange={(e) => setOptimization(prev => ({ ...prev, maxVideoAge: parseInt(e.target.value) || 24 }))}
                            disabled={!optimization.enabled}
                            min="1"
                            max="168"
                            className="w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 disabled:opacity-50"
                          />
                          <span className="text-sm text-gray-600">ì‹œê°„</span>
                        </div>
                        <div className="mt-3 text-xs text-gray-500">
                          â€¢ ê¶Œì¥: 24ì‹œê°„ (ì˜¤ëŠ˜) â­<br/>
                          â€¢ 48ì‹œê°„: ì–´ì œ + ì˜¤ëŠ˜<br/>
                          â€¢ 72ì‹œê°„: ìµœê·¼ 3ì¼<br/>
                          â€¢ ì˜¤ë˜ëœ ì˜ìƒ = ìŠ¤íŒ¸ì²˜ëŸ¼ ë³´ì„
                        </div>
                        <div className="mt-2 p-2 bg-white rounded text-xs">
                          <span className="font-bold text-orange-600">í˜„ì¬ ì„¤ì •:</span> {optimization.maxVideoAge}ì‹œê°„ ì´ë‚´ ì˜ìƒë§Œ
                        </div>
                      </div>
                    </div>
                    
                    {/* í†µê³„ */}
                    <div className="p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border-2 border-purple-200">
                      <h4 className="font-bold mb-3">ğŸ“Š ìµœì í™” í†µê³„</h4>
                      <div className="grid grid-cols-2 gap-3 text-sm">
                        <div className="p-3 bg-white rounded-lg">
                          <div className="text-gray-600 mb-1">ì ˆì•½ëœ API</div>
                          <div className="text-2xl font-bold text-green-600">{apiUsage.saved}</div>
                          <div className="text-xs text-gray-500">units</div>
                        </div>
                        <div className="p-3 bg-white rounded-lg">
                          <div className="text-gray-600 mb-1">ë‚´ ëŒ“ê¸€ ì˜ìƒ</div>
                          <div className="text-2xl font-bold text-blue-600">{myCommentedVideos.length}</div>
                          <div className="text-xs text-gray-500">ê°œ</div>
                        </div>
                        <div className="p-3 bg-white rounded-lg">
                          <div className="text-gray-600 mb-1">ì²´í¬í•œ ì˜ìƒ ID</div>
                          <div className="text-2xl font-bold text-purple-600">
                            {Object.values(checkedVideoIds).reduce((sum, arr) => sum + arr.length, 0)}
                          </div>
                          <div className="text-xs text-gray-500">ê°œ</div>
                        </div>
                        <div className="p-3 bg-white rounded-lg">
                          <div className="text-gray-600 mb-1">ì ˆì•½ë¥ </div>
                          <div className="text-2xl font-bold text-orange-600">
                            {apiUsage.youtube > 0 ? Math.round((apiUsage.saved / (apiUsage.youtube + apiUsage.saved)) * 100) : 0}%
                          </div>
                          <div className="text-xs text-gray-500">ì˜ˆìƒ</div>
                        </div>
                      </div>
                      
                      {/* ì˜ˆìƒ ì ˆì•½ */}
                      <div className="mt-4 p-3 bg-white rounded-lg">
                        <div className="text-sm mb-2">
                          <span className="font-bold">ğŸ’¡ ì˜ˆìƒ ì ˆì•½ë¥ :</span>
                          <span className="ml-2 text-green-600 font-bold">70-80%</span>
                        </div>
                        <div className="text-xs text-gray-600">
                          â€¢ ì±„ë„ 1ê°œ Ã— 24ì‹œê°„ ëª¨ë‹ˆí„°ë§<br/>
                          â€¢ Before: 28,800 units/day<br/>
                          â€¢ After: 5,760 units/day (80% ì ˆì•½)<br/>
                          â€¢ ë¬´ë£Œ í•œë„(10,000) ë‚´ ì‚¬ìš© ê°€ëŠ¥!
                        </div>
                      </div>
                    </div>
                    
                    {/* ì´ˆê¸°í™” ë²„íŠ¼ */}
                    <div className="mt-6 flex justify-end">
                      <button
                        onClick={resetOptimization}
                        className="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-bold"
                      >
                        ğŸ”„ ìµœì í™” ë°ì´í„° ì´ˆê¸°í™”
                      </button>
                    </div>
                  </div>
                )}

                {/* Comments Tab */}
                {currentTab === 'comments' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-xl font-bold">ğŸ’¬ ì‘ì„±ëœ ëŒ“ê¸€</h2>
                      <div className="text-sm text-gray-600">
                        ì´ {comments.filter(c => commentFilter === 'all' || c.source === commentFilter).length}ê°œ
                      </div>
                    </div>
                    
                    {/* í•„í„° ë²„íŠ¼ */}
                    {comments.length > 0 && (
                      <div className="flex gap-2 mb-4 overflow-x-auto">
                        <button
                          onClick={() => setCommentFilter('all')}
                          className={`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap ${
                            commentFilter === 'all'
                              ? 'bg-blue-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          ì „ì²´ ({comments.length})
                        </button>
                        <button
                          onClick={() => setCommentFilter('channel')}
                          className={`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap ${
                            commentFilter === 'channel'
                              ? 'bg-blue-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          ğŸ“º ì±„ë„ ({comments.filter(c => c.source === 'channel').length})
                        </button>
                        <button
                          onClick={() => setCommentFilter('hashtag')}
                          className={`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap ${
                            commentFilter === 'hashtag'
                              ? 'bg-green-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          ğŸ·ï¸ í•´ì‹œíƒœê·¸ ({comments.filter(c => c.source === 'hashtag').length})
                        </button>
                        <button
                          onClick={() => setCommentFilter('keyword')}
                          className={`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap ${
                            commentFilter === 'keyword'
                              ? 'bg-purple-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          ğŸ” í‚¤ì›Œë“œ ({comments.filter(c => c.source === 'keyword').length})
                        </button>
                        <button
                          onClick={() => setCommentFilter('ai')}
                          className={`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap ${
                            commentFilter === 'ai'
                              ? 'bg-pink-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          ğŸ¤– AI ({comments.filter(c => c.source === 'ai').length})
                        </button>
                      </div>
                    )}
                    
                    {comments.length === 0 ? (
                      <div className="text-center py-12 text-gray-400">
                        <p className="text-5xl mb-4">ğŸ’¬</p>
                        <p>ì‘ì„±ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        <p className="text-sm mt-2">ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•˜ë©´ ëŒ“ê¸€ì´ ì‘ì„±ë©ë‹ˆë‹¤</p>
                      </div>
                    ) : (
                      <div className="space-y-3">
                        {comments
                          .filter(c => commentFilter === 'all' || c.source === commentFilter)
                          .map(comment => (
                          <div key={comment.id} className="border rounded-lg p-4">
                            <div className="flex justify-between items-start mb-2">
                              <div className="flex items-center gap-2">
                                {comment.source && (
                                  <span className={`text-xs px-2 py-1 rounded font-bold ${
                                    comment.source === 'channel' ? 'bg-blue-100 text-blue-800' :
                                    comment.source === 'hashtag' ? 'bg-green-100 text-green-800' :
                                    'bg-gray-100 text-gray-800'
                                  }`}>
                                    {comment.icon || 'ğŸ’¬'} {comment.label || comment.source}
                                  </span>
                                )}
                                <div className="font-medium text-sm text-gray-600">{comment.sourceDetail || comment.channel}</div>
                              </div>
                              <span className="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">âœ“ ì‘ì„±ë¨</span>
                            </div>
                            <div className="font-bold mb-2">{comment.videoTitle}</div>
                            <div className="text-gray-700 mb-2 bg-gray-50 p-3 rounded">{comment.text}</div>
                            <div className="space-y-2">
                              <div className="flex gap-2 text-xs items-center">
                                <span className="text-gray-500 font-medium">ğŸ”— ëŒ“ê¸€ ë§í¬:</span>
                                <a
                                  href={`https://www.youtube.com/watch?v=${comment.videoId}&lc=${comment.id}`}
                                  target="_blank"
                                  className="text-blue-600 hover:underline break-all"
                                >
                                  https://www.youtube.com/watch?v={comment.videoId}&lc={comment.id}
                                </a>
                              </div>
                              <div className="flex gap-2 text-xs text-gray-600">
                                <span>ğŸ“… {new Date(comment.timestamp).toLocaleString('ko-KR')}</span>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}

                {/* Logs Tab */}
                {currentTab === 'logs' && (
                  <div className="bg-white rounded-xl p-6 shadow">
                    <h2 className="text-xl font-bold mb-4">ğŸ“‹ í™œë™ ë¡œê·¸</h2>
                    
                    {logs.length === 0 ? (
                      <div className="text-center py-12 text-gray-400">
                        <p className="text-5xl mb-4">ğŸ“‹</p>
                        <p>ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                      </div>
                    ) : (
                      <div className="space-y-2 max-h-[600px] overflow-y-auto">
                        {logs.map(log => (
                          <div
                            key={log.id}
                            className={`p-3 rounded-lg text-sm ${
                              log.type === 'success' ? 'bg-green-50 text-green-800' :
                              log.type === 'warning' ? 'bg-yellow-50 text-yellow-800' :
                              log.type === 'error' ? 'bg-red-50 text-red-800' :
                              'bg-gray-50 text-gray-800'
                            }`}
                          >
                            <span className="text-xs text-gray-500 mr-2">[{log.time}]</span>
                            <span className="break-all">{renderLogMessage(log.msg)}</span>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
